# ==================================================
# General Secrets & Credentials
# ==================================================

policy-red-flag-1:
  languages: [yaml, json, bash]
  severity: ERROR
  pattern-regex: (?i)(password|passwd|pwd|token|secret|apikey)\s*[:=]\s*["'][^"']+["']

policy-red-flag-2:
  languages: [yaml, json, bash]
  severity: ERROR
  pattern-regex: (?i)[A-Za-z0-9+/]{40,}={0,2}

policy-red-flag-3:
  languages: [yaml, json, bash]
  severity: ERROR
  pattern-regex: (?i)(secret|token|password).*(env|ci|pipeline)

# ==================================================
# Database Security (SAP)
# ==================================================

policy-red-flag-4:
  languages: [yaml, none]
  severity: ERROR
  pattern-regex: (?i)(db_|database_)?(user|username|password)\s*[:=]\s*["'][^"']+["']

policy-red-flag-5:
  languages: [yaml, none]
  severity: ERROR
  pattern-regex: (?i)(jdbc|database).*(ssl=false|tls=false)

policy-red-flag-6:
  languages: [yaml, none]
  severity: ERROR
  pattern-regex: (?i)(select|insert|update|delete).*(\+|concat)

policy-red-flag-7:
  languages: [yaml, none]
  severity: WARNING
  pattern-regex: (?i)(db_|database_)?user\s*[:=]\s*(root|sys|dba)

# ==================================================
# Operating System Security
# ==================================================

policy-red-flag-8:
  languages: [bash]
  severity: ERROR
  pattern-regex: (?i)(sshpass|echo\s+.*password|sudo\s+-S)

policy-red-flag-9:
  languages: [bash]
  severity: ERROR
  pattern-regex: chmod\s+777

policy-red-flag-10:
  languages: [bash]
  severity: WARNING
  pattern-regex: (?i)(setenforce\s+0|apparmor_parser\s+-R)

policy-red-flag-11:
  languages: [bash]
  severity: ERROR
  pattern-regex: (?i)(md5|sha1)

# ==================================================
# SAP Web Dispatcher / Web Tier
# ==================================================

policy-red-flag-12:
  languages: [yaml, none]
  severity: ERROR
  pattern-regex: (?i)(http://|PROT=HTTP)

policy-red-flag-13:
  languages: [none]
  severity: ERROR
  pattern-regex: (?i)(ssl_verify\s*=\s*false|verify_client\s*=\s*false)

policy-red-flag-14:
  languages: [yaml, none]
  severity: ERROR
  pattern-regex: (?i)(password|passwd|pwd)\s*=\s*.+

policy-red-flag-15:
  languages: [none]
  severity: WARNING
  pattern-regex: (?i)backend\s*=\s*\*
